/*!
 * jQuery Plugin: Are-You-Sure (Dirty Form Detection)
 * https://github.com/codedance/jquery.AreYouSure/
 *
 * Copyright (c) 2012-2014, Chris Dance and PaperCut Software http://www.papercut.com/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Author:  chris.dance@papercut.com
 * Version: 1.9.0
 * Date:    13th August 2014
 */
!function(a){a.fn.areYouSure=function(b){var c=a.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,silent:!1,addRemoveFieldsMarksDirty:!1,fieldEvents:"change keyup propertychange input",fieldSelector:":input:not(input[type=submit]):not(input[type=button])"},b),d=function(b){if(b.hasClass("ays-ignore")||b.hasClass("aysIgnore")||b.attr("data-ays-ignore")||void 0===b.attr("name"))return null;if(b.is(":disabled"))return"ays-disabled";var c,d=b.attr("type");switch(b.is("select")&&(d="select"),d){case"checkbox":case"radio":c=b.is(":checked");break;case"select":c="",b.find("option").each(function(b){var d=a(this);d.is(":selected")&&(c+=d.val())});break;default:c=b.val()}return c},e=function(a){a.data("ays-orig",d(a))},f=function(b){var e=function(a){var b=a.data("ays-orig");return void 0!==b&&d(a)!=b},f=a(this).is("form")?a(this):a(this).parents("form");if(e(a(b.target)))return void h(f,!0);if($fields=f.find(c.fieldSelector),c.addRemoveFieldsMarksDirty){var g=f.data("ays-orig-field-count");if(g!=$fields.length)return void h(f,!0)}var i=!1;$fields.each(function(){if($field=a(this),e($field))return i=!0,!1}),h(f,i)},g=function(b){var d=b.find(c.fieldSelector);a(d).each(function(){e(a(this))}),a(d).unbind(c.fieldEvents,f),a(d).bind(c.fieldEvents,f),b.data("ays-orig-field-count",a(d).length),h(b,!1)},h=function(a,b){var d=b!=a.hasClass(c.dirtyClass);a.toggleClass(c.dirtyClass,b),d&&(c.change&&c.change.call(a,a),b&&a.trigger("dirty.areYouSure",[a]),b||a.trigger("clean.areYouSure",[a]),a.trigger("change.areYouSure",[a]))},i=function(){var b=a(this),d=b.find(c.fieldSelector);a(d).each(function(){var b=a(this);b.data("ays-orig")||(e(b),b.bind(c.fieldEvents,f))}),b.trigger("checkform.areYouSure")},j=function(){g(a(this))};return c.silent||window.aysUnloadSet||(window.aysUnloadSet=!0,a(window).bind("beforeunload",function(){if($dirtyForms=a("form").filter("."+c.dirtyClass),0!=$dirtyForms.length){if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted)return;window.aysHasPrompted=!0,window.setTimeout(function(){window.aysHasPrompted=!1},900)}return c.message}})),this.each(function(b){if(a(this).is("form")){var d=a(this);d.submit(function(){d.removeClass(c.dirtyClass)}),d.bind("reset",function(){h(d,!1)}),d.bind("rescan.areYouSure",i),d.bind("reinitialize.areYouSure",j),d.bind("checkform.areYouSure",f),g(d)}})}}(jQuery);